---
title: "Homomorphic Linear Regression"
author: Kee Siong Ng
date: '2018-01-01'
bibliography: ../bibtex/ipam2018.bib
link-citations: true
categories: []
tags: []
---



<section id="note" class="level2">
<h2>Note</h2>
<p>This example was communicated to me by Kee Siong Ng. I have adapted it for use here.</p>
</section>
<section id="a-synthetic-data-set" class="level2">
<h2>A Synthetic Data Set</h2>
<pre class="r"><code>n &lt;- 50
x1 = 11:(10+n)
x2 = runif(n,5,95)
x3 = rbinom(n,1,0.5)

x = data.frame(x1,x2,x3)
x = scale(x)
x = data.frame(1,x)    # the intercept is handled using a column of 1&#39;s

sigma = 1.4
eps = rnorm(x1, 0, sigma)  # generate noise vector

b = c(17, -2.5, 0.5,-5.2)   # the real model coefficient

y = b[1] + b[2] * x[,2] + b[3] * x[,3] + b[4] * x[,4] + scale(eps)  # target variable

##############################################################################
# Batch Gradient Descent algorithm, here for benchmarking and error checking
# For a refresher on the algorithm, read the first 6 pages of
#    http://cs229.stanford.edu/notes/cs229-notes1.pdf
##############################################################################

lm_sgd &lt;- function(iter, rate) {
  theta = c(0,0,0,0)
  alpha = rate
  for (iter in 1:iter) {
     adj = c(0,0,0,0)
     for (i in 1:4) {
         for (j in 1:n) {
             adj[i] = adj[i] + (sum(x[j,] * theta) - y[j]) * x[j,i]
         }
         # theta[i] = theta[i] - (alpha / n) * adj[i]         # adjust as we go is faster
     }
     for (i in 1:4) theta[i] = theta[i] - (alpha / n) * adj[i]
     print(adj)
  }
  print(theta)
}

lm_sgd(100, 0.1)</code></pre>
<pre><code>## [1] -850.0000  107.9384 -100.0566  241.1584
## [1] -765.00000   99.29541  -83.11128  215.65124
## [1] -688.50000   91.31059  -68.57486  193.04833
## [1] -619.65000   83.93974  -56.12691  173.00240
## [1] -557.68500   77.14066  -45.48836  155.20893
## [1] -501.91650   70.87320  -36.41628  139.40079
## [1] -451.72485   65.09937  -28.69929  125.34360
## [1] -406.55237   59.78326  -22.15345  112.83162
## [1] -365.89713   54.89110  -16.61883  101.68420
## [1] -329.30742   50.39120  -11.95639   91.74263
## [1] -296.376674   46.253849   -8.045335   82.867442
## [1] -266.73901   42.45132   -4.78073   74.93600
## [1] -240.065106   38.957728   -2.071504   67.840434
## [1] -216.0585954   35.7489959    0.1613561   61.4857948
## [1] -194.452736   32.802728    1.986353   55.788480
## [1] -175.00746   30.09814    3.46284   50.67483
## [1] -157.506716   27.615973    4.642201   46.079891
## [1] -141.756044   25.338381    5.568889   41.946390
## [1] -127.580440   23.248868    6.281323   38.223755
## [1] -114.822396   21.332190    6.812672   34.867318
## [1] -103.340156   19.574276    7.191549   31.837597
## [1] -93.006141  17.962146   7.442598  29.099667
## [1] -83.705527  16.483837   7.587024  26.622611
## [1] -75.334974  15.128332   7.643041  24.379035
## [1] -67.801477  13.885492   7.626272  22.344653
## [1] -61.02133  12.74599   7.55009  20.49791
## [1] -54.919196  11.701243   7.425921  18.819657
## [1] -49.427276  10.743379   7.263505  17.292876
## [1] -44.484549   9.865158   7.071121  15.902418
## [1] -40.036094   9.059934   6.855789  14.634792
## [1] -36.032485   8.321610   6.623439  13.477966
## [1] -32.429236   7.644589   6.379061  12.421203
## [1] -29.186312   7.023740   6.126839  11.454909
## [1] -26.267681   6.454358   5.870259  10.570504
## [1] -23.640913   5.932130   5.612208   9.760304
## [1] -21.276822   5.453103   5.355062   9.017422
## [1] -19.149140   5.013655   5.100759   8.335678
## [1] -17.234226   4.610469   4.850860   7.709520
## [1] -15.510803   4.240504   4.606608   7.133954
## [1] -13.959723   3.900977   4.368972   6.604483
## [1] -12.563751   3.589339   4.138695   6.117056
## [1] -11.307375   3.303255   3.916321   5.668013
## [1] -10.176638   3.040590   3.702234   5.254049
## [1] -9.158974  2.799385  3.496680  4.872175
## [1] -8.243077  2.577850  3.299789  4.519684
## [1] -7.418769  2.374345  3.111600  4.194121
## [1] -6.676892  2.187367  2.932070  3.893258
## [1] -6.009203  2.015543  2.761097  3.615071
## [1] -5.408283  1.857614  2.598526  3.357719
## [1] -4.867454  1.712428  2.444161  3.119525
## [1] -4.380709  1.578930  2.297777  2.898961
## [1] -3.942638  1.456153  2.159121  2.694633
## [1] -3.548374  1.343214  2.027926  2.505266
## [1] -3.193537  1.239303  1.903912  2.329696
## [1] -2.874183  1.143677  1.786791  2.166857
## [1] -2.586765  1.055656  1.676270  2.015774
## [1] -2.3280883  0.9746196  1.5720561  1.8755502
## [1] -2.0952795  0.8999957  1.4738584  1.7453653
## [1] -1.8857515  0.8312621  1.3813891  1.6244648
## [1] -1.697176  0.767940  1.294366  1.512155
## [1] -1.5274588  0.7095903  1.2125139  1.4077994
## [1] -1.3747129  0.6558105  1.1355646  1.3108095
## [1] -1.2372416  0.6062317  1.0632592  1.2206452
## [1] -1.1135174  0.5605156  0.9953473  1.1368077
## [1] -1.0021657  0.5183518  0.9315883  1.0588373
## [1] -0.9019491  0.4794556  0.8717512  0.9863094
## [1] -0.8117542  0.4435658  0.8156149  0.9188321
## [1] -0.7305788  0.4104428  0.7629681  0.8560431
## [1] -0.6575209  0.3798665  0.7136092  0.7976073
## [1] -0.5917688  0.3516348  0.6673465  0.7432150
## [1] -0.5325919  0.3255624  0.6239975  0.6925792
## [1] -0.4793327  0.3014789  0.5833891  0.6454345
## [1] -0.4313995  0.2792278  0.5453571  0.6015348
## [1] -0.3882595  0.2586653  0.5097461  0.5606522
## [1] -0.3494336  0.2396593  0.4764090  0.5225751
## [1] -0.3144902  0.2220883  0.4452067  0.4871076
## [1] -0.2830412  0.2058405  0.4160080  0.4540677
## [1] -0.2547371  0.1908133  0.3886889  0.4232866
## [1] -0.2292634  0.1769121  0.3631327  0.3946076
## [1] -0.2063370  0.1640501  0.3392292  0.3678851
## [1] -0.1857033  0.1521472  0.3168749  0.3429838
## [1] -0.1671330  0.1411298  0.2959723  0.3197780
## [1] -0.1504197  0.1309300  0.2764294  0.2981511
## [1] -0.1353777  0.1214854  0.2581602  0.2779944
## [1] -0.1218400  0.1127385  0.2410836  0.2592070
## [1] -0.1096560  0.1046362  0.2251234  0.2416950
## [1] -0.09869036  0.09712971  0.21020816  0.22537098
## [1] -0.08882132  0.09017400  0.19627084  0.21015378
## [1] -0.07993919  0.08372752  0.18324850  0.19596775
## [1] -0.07194527  0.07775200  0.17108211  0.18274253
## [1] -0.06475075  0.07221209  0.15971634  0.17041260
## [1] -0.05827567  0.06707521  0.14909931  0.15891698
## [1] -0.05244810  0.06231127  0.13918244  0.14819890
## [1] -0.04720329  0.05789250  0.12992018  0.13820549
## [1] -0.04248296  0.05379328  0.12126989  0.12888750
## [1] -0.03823467  0.04998991  0.11319163  0.12019907
## [1] -0.03441120  0.04646052  0.10564803  0.11209749
## [1] -0.03097008  0.04318492  0.09860408  0.10454296
## [1] -0.02787307  0.04014442  0.09202704  0.09749840
## [1] -0.02508577  0.03732175  0.08588627  0.09092927
## [1] 16.9995485 -2.6522530  0.5184577 -5.0141792</code></pre>
<pre class="r"><code>##########################################################################################
# Distributed Privacy-Preserving Gradient Descent algorithm for Linear Regression
##########################################################################################
# Basic setup:
# FIU holds the vector y of true labels
# RE1 holds the data x[,1:3]
# RE2 holds the data x[,4]
# Together, they want to learn a linear model to predict y using x but in such a way that
# - nobody sees each other&#39;s data,
# - RE1 holds the coefficients for the variables it holds, which is not visible to others
# - RE2 holds the coefficients for the variables it holds, which is not visible to others
# - Prediction of a new instance requires the collaboration of RE1 and RE2
###########################################################################################

###############################################################################################
# FIU first generates a public-private key pair using the Paillier scheme
# Public key is used by RE1 and RE2 to encrypt their data and do maths on them.
# Private key is visible only to FIU and is used by the FIU to decrypt data sent from the REs.
###########

library(homomorpheR)

keypair = PaillierKeyPair$new(modulusBits = 1024)
pubkey = keypair$pubkey
privkey = keypair$getPrivateKey()

# Convenience function
zipf = function(x1,x2,x3) {
  res = c()
  for (i in 1:length(x1)) res = c(res,x1[i],x2[i],x3[i])
  res
}

# zipf(5,10,1)
# zipf(c(1,2,3), c(4,5,6), c(1,1,1))

######################################################################
# Paillier is defined only on positive integers.
# We approximate a floating point number X by 3 integers (a,b,c)
# such that X is approximately equal to (a + b/largenum) / 10^c
#
# Example: Assuming largenum = 2^10, 5.2 can be represented by
#  (5, 204, 0) = (5 + 204/1024) / 1 = 5.19922
#  or (50, 2040, 1) = (50 + 2040/1024) / 10 = 5.19922
#
# In general, the larger largenum is, the better the approximation.
#################

largenum = 2^50
encodeFloat = function(x, e=0) {
  x = x * 10^e
  x1 = floor(x)
  x2 = x - x1
  x2 = floor(x2 * largenum)
  exps = rep(e, length(x))
  zipf(x1,x2,exps)
}

# encodeFloat(5.2)
# encodeFloat(5.2, 2)
# encodeFloat(c(4.5,5.2,7), 1)

# Some useful constants
zero = pubkey$encrypt(&#39;0&#39;)
one = pubkey$encrypt(&#39;1&#39;)

############################################################################
# We encrypt each number (a,b,c) by encrypting a and b with the public key
# The input can be a vector of numbers
################

encrypt = function(z, e=0) {
  y = encodeFloat(z, e)
  res = rep(zero, length(y))
  for (i in 1:length(y)) {
      if (i %% 3 == 0) { res[i] = y[i] }
      else { res[i] = pubkey$encrypt(as.character(y[i])) }
  }
  res
}

############################################################################
# We decrypt each encrypted number (enc(a), enc(b),c) using the private key
# by computing (dec(enc(a)) + dec(enc(b))/largenum) / 10^c
# The input can be a vector of numbers.
# We need to deal with negative numbers too.
##################

decrypt = function(en) {
  uen = en
  for (i in 1:length(uen)) {
      if (i %% 3 != 0) uen[i] = privkey$decrypt(en[i])
  }
  # deal with negative results;
  # see https://crypto.stackexchange.com/questions/19457/how-can-i-do-minus-on-plaintexts-in-the-paillier-cryptosystem
  for (i in 1:length(uen)) {
    if (i %% 3 != 0 &amp;&amp;    # don&#39;t process exponents
        uen[i] &gt;= as.double(pubkey$n/3.0)) { uen[i] = uen[i] - pubkey$n }
  }
  res = c()
  for (i in seq(1, length(uen), 3)) {
      res = c(res,
             (as.double(uen[i]) + as.double(uen[i+1]/(largenum))) / as.double(10^uen[i+2]))
  }
  return(res)
}

# decrypt(encrypt(4.7))
# decrypt(encrypt(0.5))
# decrypt(encrypt(-2.3))
# (z = encrypt(c(5.2,4.7,-2.6)))
# decrypt(z)

############################################################################
# We next define addition of two encrypted numbers: (enc(a1), enc(b1), c1) and (enc(a2), enc(b2), c2).
# Addition can be done on the encrypted a&#39;s and encrypted b&#39;s if c1 = c2. We make c1 = c2 true by
# multiplying by powers of 10 when necessary.
# The need to make c1 = c2 is the reason why we can&#39;t have c1 and c2 encrypted.
# The function works on vectors.
###############

addenc = function(x, y) {
  res = x
  for (i in seq(1, length(x), 3)) {
       if (x[i+2] != y[i+2]) {  # if different exponent, make the exponents equal by multiplying
          res[i+2] = max(x[i+2], y[i+2])
          xdiff = res[i+2] - x[i+2]
          ydiff = res[i+2] - y[i+2]
          if (xdiff &gt; 0) {
              x[i] = pubkey$mult(x[i], 10^(xdiff))
              x[i+1] = pubkey$mult(x[i+1], 10^(xdiff))
          }
          if (ydiff &gt; 0) {
              y[i] = pubkey$mult(y[i], 10^(ydiff))
              y[i+1] = pubkey$mult(y[i+1], 10^(ydiff))
          }
       }
       res[i] = pubkey$add(x[i], y[i])
       # print(privkey$decrypt(c(x[i], y[i], res[i])))
       res[i+1] = pubkey$add(x[i+1], y[i+1])
  }
  res
}

############################################################################
# We next define subtraction of two encrypted numbers: (enc(a1), enc(b1), c1) and (enc(a2), enc(b2), c2).
# We simply multiply the second encrypted number by -1 and then add it to the first encrypted number.
############

subenc = function(x, y) {
  for (i in seq(1, length(x), 3)) {
      # y[i:i+1] = pubkey$mult(y[i:i+1], -1)  # this doesn&#39;t work, why?
      y[i] = pubkey$mult(y[i], -1)
      y[i+1] = pubkey$mult(y[i+1], -1)
  }
  addenc(x, y)
}

#############################################################################################
# We next define the multiplication of an encrypted number en = (enc(a),enc(b),c) by a scalar y
# Again, Paillier only allows y to be an integer. To deal with floating point numbers, we use
# en * y = en * (y_int + y_frac)
#        = en * y_int + (enc(a) * floor(y_frac * 10^n), enc(b) * floor(y_frac * 10^n), n)
# where n is a parameter with larger n leading to better approximation. We use n = 3 below.
#######

smultenc = function(x,y) {
  yint = floor(y * 1000)
  res = x
  for (i in seq(1, length(x), 3)) {
      res[i] = pubkey$mult(x[i], yint)
      res[i+1] = pubkey$mult(x[i+1], yint)
      res[i+2] =  x[i+2] + 3
  }
  res
}

################
# Here are some test cases
####
# five = encrypt(5.4)
# ten = encrypt(10.2)
# five
# ten
# decrypt(addenc(five,ten))
# decrypt(subenc(ten,five))
# decrypt(subenc(five,ten))
# decrypt(addenc(c(five,ten), c(ten,ten)))
#
# five = encrypt(5.4,1)
# ten = encrypt(10.2,2)
# decrypt(addenc(five,ten))
# decrypt(subenc(ten,five))
# decrypt(addenc(c(five,ten), c(ten,ten)))
#
# decrypt(smultenc(five, 4))
# decrypt(smultenc(ten, 6))
# decrypt(smultenc(c(five,ten), 4))
# decrypt(smultenc(c(five,ten), -4))

##################################################################
# Here are the functions to setup the parties in the computation
#################

x1 = c()  # these 3 vectors belong to RE1
x2 = c()
x3 = c()

re1setup = function() {
  x1 &lt;&lt;- encrypt(x[,1])
  x2 &lt;&lt;- encrypt(x[,2])
  x3 &lt;&lt;- encrypt(x[,3])
}

x4 = c() # this belong to RE2

re2setup = function() {
  x4 &lt;&lt;- encrypt(x[,4])
}

mastersetup = function() {
  re1setup()
  re2setup()
}

############
# This function computes the gradient: the difference between predicted values (encrypted) by REs and the true values
# Note the gradient is unencrypted. We could encrypt it if necessary.
#########

master_grad &lt;- function(x) {
  xd = decrypt(x)
  xd - y
  # subenc(xd, y)
}

###########
# This is used to compute the partial predictions based on RE1&#39;s data only. The values are encrypted.
###########
re1pred &lt;- function() {
   # return (theta1 * x[,1] + theta2 * x[,2] + theta3 * x[,3])
  return (addenc(smultenc(x1, theta1),
          addenc(smultenc(x2, theta2),
                 smultenc(x3, theta3)))
          )
}

#############
# Here, RE2 takes the partial prediction of RE1 and then add its contribution to the prediction.
# The final prediction values are encrypted.
###########

re2pred &lt;- function(z) {
   # return (z + theta4 * x[,4])
  return (addenc(z, smultenc(x4, theta4)))
}

cadj = c(0,0,0,0) # a variable we want to print to keep track of progress

#############
# This is RE1&#39;s model update function and implements the gradient descent update formula.
# It takes the gradient (unencrypted) from the master and then adjust its own theta.
# The whole computation is assumed to take place within RE1 and no encryption is required.
# We can encrypt the whole thing if we want to.
###########

re1update &lt;- function(z) {
   theta1 &lt;&lt;- theta1 - (alpha / n) * sum(z * x[,1])
   theta2 &lt;&lt;- theta2 - (alpha / n) * sum(z * x[,2])
   theta3 &lt;&lt;- theta3 - (alpha / n) * sum(z * x[,3])
   cadj[1] &lt;&lt;- sum(z * x[,1])
   cadj[2] &lt;&lt;- sum(z * x[,2])
   cadj[3] &lt;&lt;- sum(z * x[,3])
}

#############
# This is RE2&#39;s model update function and implements the gradient descent update formula.
# It takes the gradient (unencrypted) from the master and then adjust its own theta.
# The whole computation is assumed to take place within RE1 and no encryption is required.
# We can encrypt the whole thing if we want to.
###########

re2update &lt;- function(z) {
   theta4 &lt;&lt;- theta4 - (alpha / n) * sum(z * x[,4])
   cadj[4] &lt;&lt;- sum(z * x[,4])
}

##########################################################################
# Finally, this is the privacy-preserving linear regression algorithm.
# The algorithm can be sensitive to the learning rate.
##########################################################################

pp_lm_sgd &lt;- function(iter, rate) {

  theta1 &lt;&lt;- 0
  theta2 &lt;&lt;- 0
  theta3 &lt;&lt;- 0
  theta4 &lt;&lt;- 0
  alpha &lt;&lt;- rate

  mastersetup()  # encrypt the data and set up communication

  for (i in 1:iter) {
      p1 = re1pred()     # partial prediction
      px = re2pred(p1)   # full prediction
      grad = master_grad(px)  # compute gradient based on difference between true values and predicted values
      re1update(grad)    # update models independently
      re2update(grad)
      print(cadj)
  }
  print(c(theta1,theta2,theta3,theta4))
}

model0 = lm_sgd(100, 0.1)</code></pre>
<pre><code>## [1] -850.0000  107.9384 -100.0566  241.1584
## [1] -765.00000   99.29541  -83.11128  215.65124
## [1] -688.50000   91.31059  -68.57486  193.04833
## [1] -619.65000   83.93974  -56.12691  173.00240
## [1] -557.68500   77.14066  -45.48836  155.20893
## [1] -501.91650   70.87320  -36.41628  139.40079
## [1] -451.72485   65.09937  -28.69929  125.34360
## [1] -406.55237   59.78326  -22.15345  112.83162
## [1] -365.89713   54.89110  -16.61883  101.68420
## [1] -329.30742   50.39120  -11.95639   91.74263
## [1] -296.376674   46.253849   -8.045335   82.867442
## [1] -266.73901   42.45132   -4.78073   74.93600
## [1] -240.065106   38.957728   -2.071504   67.840434
## [1] -216.0585954   35.7489959    0.1613561   61.4857948
## [1] -194.452736   32.802728    1.986353   55.788480
## [1] -175.00746   30.09814    3.46284   50.67483
## [1] -157.506716   27.615973    4.642201   46.079891
## [1] -141.756044   25.338381    5.568889   41.946390
## [1] -127.580440   23.248868    6.281323   38.223755
## [1] -114.822396   21.332190    6.812672   34.867318
## [1] -103.340156   19.574276    7.191549   31.837597
## [1] -93.006141  17.962146   7.442598  29.099667
## [1] -83.705527  16.483837   7.587024  26.622611
## [1] -75.334974  15.128332   7.643041  24.379035
## [1] -67.801477  13.885492   7.626272  22.344653
## [1] -61.02133  12.74599   7.55009  20.49791
## [1] -54.919196  11.701243   7.425921  18.819657
## [1] -49.427276  10.743379   7.263505  17.292876
## [1] -44.484549   9.865158   7.071121  15.902418
## [1] -40.036094   9.059934   6.855789  14.634792
## [1] -36.032485   8.321610   6.623439  13.477966
## [1] -32.429236   7.644589   6.379061  12.421203
## [1] -29.186312   7.023740   6.126839  11.454909
## [1] -26.267681   6.454358   5.870259  10.570504
## [1] -23.640913   5.932130   5.612208   9.760304
## [1] -21.276822   5.453103   5.355062   9.017422
## [1] -19.149140   5.013655   5.100759   8.335678
## [1] -17.234226   4.610469   4.850860   7.709520
## [1] -15.510803   4.240504   4.606608   7.133954
## [1] -13.959723   3.900977   4.368972   6.604483
## [1] -12.563751   3.589339   4.138695   6.117056
## [1] -11.307375   3.303255   3.916321   5.668013
## [1] -10.176638   3.040590   3.702234   5.254049
## [1] -9.158974  2.799385  3.496680  4.872175
## [1] -8.243077  2.577850  3.299789  4.519684
## [1] -7.418769  2.374345  3.111600  4.194121
## [1] -6.676892  2.187367  2.932070  3.893258
## [1] -6.009203  2.015543  2.761097  3.615071
## [1] -5.408283  1.857614  2.598526  3.357719
## [1] -4.867454  1.712428  2.444161  3.119525
## [1] -4.380709  1.578930  2.297777  2.898961
## [1] -3.942638  1.456153  2.159121  2.694633
## [1] -3.548374  1.343214  2.027926  2.505266
## [1] -3.193537  1.239303  1.903912  2.329696
## [1] -2.874183  1.143677  1.786791  2.166857
## [1] -2.586765  1.055656  1.676270  2.015774
## [1] -2.3280883  0.9746196  1.5720561  1.8755502
## [1] -2.0952795  0.8999957  1.4738584  1.7453653
## [1] -1.8857515  0.8312621  1.3813891  1.6244648
## [1] -1.697176  0.767940  1.294366  1.512155
## [1] -1.5274588  0.7095903  1.2125139  1.4077994
## [1] -1.3747129  0.6558105  1.1355646  1.3108095
## [1] -1.2372416  0.6062317  1.0632592  1.2206452
## [1] -1.1135174  0.5605156  0.9953473  1.1368077
## [1] -1.0021657  0.5183518  0.9315883  1.0588373
## [1] -0.9019491  0.4794556  0.8717512  0.9863094
## [1] -0.8117542  0.4435658  0.8156149  0.9188321
## [1] -0.7305788  0.4104428  0.7629681  0.8560431
## [1] -0.6575209  0.3798665  0.7136092  0.7976073
## [1] -0.5917688  0.3516348  0.6673465  0.7432150
## [1] -0.5325919  0.3255624  0.6239975  0.6925792
## [1] -0.4793327  0.3014789  0.5833891  0.6454345
## [1] -0.4313995  0.2792278  0.5453571  0.6015348
## [1] -0.3882595  0.2586653  0.5097461  0.5606522
## [1] -0.3494336  0.2396593  0.4764090  0.5225751
## [1] -0.3144902  0.2220883  0.4452067  0.4871076
## [1] -0.2830412  0.2058405  0.4160080  0.4540677
## [1] -0.2547371  0.1908133  0.3886889  0.4232866
## [1] -0.2292634  0.1769121  0.3631327  0.3946076
## [1] -0.2063370  0.1640501  0.3392292  0.3678851
## [1] -0.1857033  0.1521472  0.3168749  0.3429838
## [1] -0.1671330  0.1411298  0.2959723  0.3197780
## [1] -0.1504197  0.1309300  0.2764294  0.2981511
## [1] -0.1353777  0.1214854  0.2581602  0.2779944
## [1] -0.1218400  0.1127385  0.2410836  0.2592070
## [1] -0.1096560  0.1046362  0.2251234  0.2416950
## [1] -0.09869036  0.09712971  0.21020816  0.22537098
## [1] -0.08882132  0.09017400  0.19627084  0.21015378
## [1] -0.07993919  0.08372752  0.18324850  0.19596775
## [1] -0.07194527  0.07775200  0.17108211  0.18274253
## [1] -0.06475075  0.07221209  0.15971634  0.17041260
## [1] -0.05827567  0.06707521  0.14909931  0.15891698
## [1] -0.05244810  0.06231127  0.13918244  0.14819890
## [1] -0.04720329  0.05789250  0.12992018  0.13820549
## [1] -0.04248296  0.05379328  0.12126989  0.12888750
## [1] -0.03823467  0.04998991  0.11319163  0.12019907
## [1] -0.03441120  0.04646052  0.10564803  0.11209749
## [1] -0.03097008  0.04318492  0.09860408  0.10454296
## [1] -0.02787307  0.04014442  0.09202704  0.09749840
## [1] -0.02508577  0.03732175  0.08588627  0.09092927
## [1] 16.9995485 -2.6522530  0.5184577 -5.0141792</code></pre>
<pre class="r"><code>model1 = pp_lm_sgd(100, 0.1)</code></pre>
<pre><code>## [1] -850.0000  107.9384 -100.0566  241.1584
## [1] -765.00000   99.29261  -83.10694  215.61993
## [1] -688.50000   91.28664  -68.58523  193.03687
## [1] -619.65000   83.89698  -56.14552  172.99953
## [1] -557.70000   77.14128  -45.52057  155.20593
## [1] -501.95000   70.84122  -36.43817  139.37218
## [1] -451.75000   65.10012  -28.72531  125.34851
## [1] -406.55000   59.79442  -22.14580  112.81173
## [1] -365.90000   54.88293  -16.62088  101.65414
## [1] -329.30000   50.37098  -11.97507   91.73500
## [1] -296.400000   46.220664   -8.066376   82.883331
## [1] -266.750000   42.444323   -4.803068   74.937893
## [1] -240.100000   38.945998   -2.070408   67.830246
## [1] -216.0500000   35.7347454    0.1600956   61.4623896
## [1] -194.450000   32.812607    2.000691   55.756830
## [1] -175.000000   30.086111    3.468111   50.673622
## [1] -157.500000   27.612068    4.638605   46.095991
## [1] -141.750000   25.350534    5.541912   41.930465
## [1] -127.600000   23.245497    6.263025   38.202076
## [1] -114.85000   21.35048    6.81495   34.85730
## [1] -103.350000   19.577791    7.179666   31.821431
## [1] -93.000000  17.969407   7.439683  29.110455
## [1] -83.700000  16.491156   7.589985  26.596144
## [1] -75.350000  15.132741   7.651077  24.362251
## [1] -67.800000  13.849689   7.638449  22.364304
## [1] -61.050000  12.750298   7.529111  20.509494
## [1] -54.950000  11.680555   7.410541  18.831910
## [1] -49.450000  10.744230   7.245504  17.287744
## [1] -44.500000   9.837553   7.071236  15.920803
## [1] -40.050000   9.068822   6.864747  14.638281
## [1] -36.050000   8.340036   6.628521  13.449231
## [1] -32.450000   7.640898   6.383065  12.437407
## [1] -29.200000   7.035233   6.120877  11.465528
## [1] -26.250000   6.468271   5.877952  10.572875
## [1] -23.650000   5.941254   5.605291   9.773694
## [1] -21.250000   5.457468   5.366141   9.004740
## [1] -19.150000   5.013626   5.097254   8.329257
## [1] -17.250000   4.613015   4.861878   7.684001
## [1] -15.500000   4.252350   4.596765   7.132217
## [1] -13.950000   3.885914   4.366405   6.615186
## [1] -12.550000   3.563951   4.120555   6.142628
## [1] -11.300000   3.289746   3.922464   5.651295
## [1] -10.200000   3.055486   3.694636   5.253436
## [1] -9.150000  2.770984  3.517050  4.845856
## [1] -8.250000  2.575427  3.308485  4.527222
## [1] -7.400000  2.379870  3.099920  4.208588
## [1] -6.700000  2.183070  2.940356  3.875706
## [1] -6.000000  2.026216  2.751055  3.636298
## [1] -5.400000  1.873890  2.576000  3.347889
## [1] -4.850000  1.711266  2.421452  3.143234
## [1] -4.400000  1.553169  2.281151  2.889578
## [1] -3.950000  1.438303  2.174360  2.666148
## [1] -3.550000  1.318909  2.053323  2.491718
## [1] -3.200000  1.249758  1.882043  2.327008
## [1] -2.850000  1.124595  1.795758  2.187331
## [1] -2.600000  1.054201  1.673478  2.008374
## [1] -2.3500000  0.9780378  1.5859510  1.8641694
## [1] -2.1000000  0.9018744  1.4984240  1.7199651
## [1] -1.9000000  0.8211837  1.3966499  1.6247608
## [1] -1.700000  0.789493  1.293633  1.525029
## [1] -1.5000000  0.7088023  1.1918593  1.4298249
## [1] -1.3500000  0.6758692  1.1378428  1.3158463
## [1] -1.250000  0.593936  1.085069  1.206395
## [1] -1.1000000  0.5577180  0.9678051  1.1556634
## [1] -1.0000000  0.5247848  0.9137886  1.0416847
## [1] -0.9000000  0.4860819  0.8945251  0.9624591
## [1] -0.8000000  0.4486215  0.8262616  0.8974804
## [1] -0.7500000  0.4066337  0.7437510  0.8815018
## [1] -0.6500000  0.3679308  0.7244875  0.8022762
## [1] -0.6000000  0.3304703  0.6562239  0.7372975
## [1] -0.5500000  0.3362400  0.6214710  0.7025445
## [1] -0.5000000  0.2975371  0.6022074  0.6233189
## [1] -0.4500000  0.3045493  0.5184544  0.6028129
## [1] -0.4000000  0.2613191  0.4849439  0.5725873
## [1] -0.3500000  0.2180889  0.4514333  0.5423616
## [1] -0.3000000  0.2226162  0.4656804  0.4933616
## [1] -0.3000000  0.2283860  0.4309274  0.4586086
## [1] -0.2500000  0.1851557  0.3974168  0.4283830
## [1] -0.2000000  0.1909255  0.3626638  0.3936300
## [1] -0.2000000  0.1476953  0.3291533  0.3634043
## [1] -0.2000000  0.1522226  0.3434003  0.3144043
## [1] -0.1500000  0.1534650  0.2944003  0.3286514
## [1] -0.1500000  0.1102348  0.2608898  0.2984257
## [1] -0.1500000  0.1102348  0.2608898  0.2984257
## [1] -0.1000000  0.1160045  0.2261368  0.2636727
## [1] -0.1000000  0.1205319  0.2403838  0.2146727
## [1] -0.10000000  0.07277431  0.19262622  0.23344708
## [1] -0.10000000  0.07277431  0.19262622  0.23344708
## [1] -0.10000000  0.07730164  0.20687324  0.18444708
## [1] -0.05000000  0.07854407  0.15787324  0.19869410
## [1] -0.0500000  0.0830714  0.1721203  0.1496941
## [1] -0.0500000  0.0830714  0.1721203  0.1496941
## [1] -0.05000000  0.08431383  0.12312025  0.16394111
## [1] -0.05000000  0.03984117  0.13860970  0.11946845
## [1] -0.05000000  0.03984117  0.13860970  0.11946845
## [1] -0.0500000  0.0410836  0.0896097  0.1337155
## [1] -0.0500000  0.0410836  0.0896097  0.1337155
## [1] -0.05000000  0.04561093  0.10385672  0.08471546
## [1] 1.110223e-13 4.561093e-02 1.038567e-01 8.471546e-02
## [1] 1.110223e-13 4.561093e-02 1.038567e-01 8.471546e-02
## [1] 17.0001000 -2.6517299  0.5188885 -5.0136383</code></pre>
<pre class="r"><code>## References</code></pre>
</section>
